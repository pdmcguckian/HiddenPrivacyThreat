<!doctype html>
<html>

<head>
	<meta charset="UTF-8">
	<title>P. D. McGuckian | SIoT Dashboard</title>

	<meta property="og:title" h_footercontent='P. D. McGuckian | SIoT Dashboard'/>
    <meta name="viewport" content="width=device-width, initial-scale=0.86, maximum-scale=3.0, minimum-scale=0.86">

	<link rel="stylesheet" href="pdmcguckian.css">
	<link rel="stylesheet" href="https://use.typekit.net/jcz8ueb.css">

	<link rel="icon" href="/favicon.ico">
	<link rel="apple-touch-icon" href="/favicon192.png">
	
	<!-- The core Firebase JS SDK is always required and must be listed first -->
	<script src="https://www.gstatic.com/firebasejs/7.19.0/firebase-app.js"></script>

	<!-- TODO: Add SDKs for Firebase products that you want to use
		https://firebase.google.com/docs/web/setup#available-libraries -->
	<script src="https://www.gstatic.com/firebasejs/7.19.0/firebase-analytics.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>

	<script>
	// Your web app's Firebase configuration
	var firebaseConfig = {
		apiKey: "AIzaSyDLV7i3s09cZ19wyP1AP1SdeTqNyP3jnX0",
		authDomain: "portfolio-36a49.firebaseapp.com",
		databaseURL: "https://portfolio-36a49.firebaseio.com",
		projectId: "portfolio-36a49",
		storageBucket: "portfolio-36a49.appspot.com",
		messagingSenderId: "886630373892",
		appId: "1:886630373892:web:4d62d4625d110d5315f351",
		measurementId: "G-H76XH15R9E"
	};
	// Initialize Firebase
	firebase.initializeApp(firebaseConfig);
	firebase.analytics();
	</script>	

</head>

<body>

	<div class="h_cardheader">
		<div id="aboutcard" class="cardhover" onmouseover="projectCards(0)"><p>About</p></div>
		<div id="predictionscard" class="card" onmouseover="projectCards(1)"><p>Predictions</p></div>
		<div id="truedatacard" class="card" onmouseover="projectCards(2)"><p>True Data</p></div>
	</div>


	<div class="h_main" id="desktop">
		<div class="h_about" id="about">
			
			<div class="h_headersection">
				<div><h1>About</h1></div>
				<div class="h_datebuttons">
					<a class="buttons" href="#" onclick="change_date(-1);"><p>Day Back</p></a>
					<h2 id="date1"></h2>
					<a class="buttons" href="#" onclick="change_date(1);"><p>Day Forward</p></a>
				</div>
			</div>
			
			<div class="h_aboutcontent">
				<div class="h_col1">
					<h5>Most consumers, when asked say they are extremely concerned about data privacy - finding the idea that technology companies can infer information like their sleep schedulues, emotional state, drinking habits and then sell it to their insurance provider or employer absolutely horrifying.</h5>
					<h5>However consumers continue to buy and use the data collecting smart home devices that these companies use to make these predictions. This is because studies have shown that typical consumers are unaware of how valuable the information these devices collect can be.</h5>
					<h5>Thus to demonstarate the privacy risks these devices represent I have placed BLE beacons in my flat to simulaute a home full of smart devices tracking my activity and I have been using the data to predict what most people would call sensitive information. The video explains how it works.</h5>
				</div>

				<div class="h_col2">
					<div class="h_introvideoboarder">
						<div id="h_projectvideo">
							<video controls class="h_video">
								<source src="opaque_main.mp4" type="video/mp4">
							</video>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="h_predictions" id="predictions">
			<div class="h_headersection">
				<div><h1>Predictions</h1></div>
				<div class="h_datebuttons">
					<a class="buttons" href="#" onclick="change_date(-1);"><p>Day Back</p></a>
					<h2 id="date2"></h2>
					<a class="buttons" href="#" onclick="change_date(1);"><p>Day Forward</p></a>
				</div>
			</div>
			<h2>Room Prediction</h2>
			<div class="h_predictionscontent">
				<canvas id="roomlocation" style="width:100%"></canvas>
			</div>
	
		</div>


		<div class="h_truedata" id="truedata">
			<div class="h_headersection">
				<div><h1>True Data</h1></div>
				<div class="h_datebuttons">
					<a class="buttons" href="#" onclick="change_date(-1);"><p>Day Back</p></a>
					<h2 id="date3"></h2>
					<a class="buttons"href="#" onclick="change_date(1);"><p>Day Forward</p></a>
				</div>
			</div>
			<div class="h_truedatacontent">
				<div class="h_col1">
					<h2>Bedroom BLE Data</h2>
					<canvas id="bedroom" style="width:45%"></canvas>
					<h2>Living Room BLE Data</h2>
					<canvas id="livingroom" style="width:45%"></canvas>
				</div>
				<div class="h_col2">
					<h2>Kitchen BLE Data</h2>
					<canvas id="kitchen" style="width:45%"></canvas>
					<h2>Event Data</h2>
					<div class="h_truedatacontent">
						<div class="h_col1">
							<p>h1</p>
						</div>
						<div class="h_col2">
							<p>h1</p>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	





	<div class="h_main_mob" id="mobile">
		
	</div>

</body>	

<script>
	function projectCards(section) {
		var about = document.getElementById("about");
		var predictions = document.getElementById("predictions");
		var truedata = document.getElementById("truedata");

		document.getElementById("aboutcard").className = "card";
		document.getElementById("predictionscard").className = "cardhover";
		document.getElementById("truedatacard").className = "card";
		
		if (section===0) {
			about.style.display = "flex";
			predictions.style.display = "none";
			truedata.style.display = "none";

			document.getElementById("aboutcard").className = "cardhover";
			document.getElementById("predictionscard").className = "card";
			document.getElementById("truedatacard").className = "card";
		}

		if (section===1) {
			about.style.display = "none";
			predictions.style.display = "flex";
			truedata.style.display = "none";

			document.getElementById("aboutcard").className = "card";
			document.getElementById("predictionscard").className = "cardhover";
			document.getElementById("truedatacard").className = "card";
		}
		
		if (section===2) {
			about.style.display = "none";
			predictions.style.display = "none";
			truedata.style.display = "flex";

			document.getElementById("aboutcard").className = "card";
			document.getElementById("predictionscard").className = "card";
			document.getElementById("truedatacard").className = "cardhover";
		}
}
</script>

<script>
	var dateControl = 25;
	var date = new Date("November " + dateControl + ", 2021")
	change_date_text();
	render_true_graphs();
	render_prediction_graphs();

	function change_date(direction) {
		if (dateControl < 26 && dateControl > 12) {
		dateControl = dateControl + direction;
		date = new Date("November " + dateControl + ", 2021")
		change_date_text();
		render_true_graphs();
		render_prediction_graphs()}}

	function change_date_text(direction) {
		document.getElementById('date1').innerHTML = date.toISOString().substring(0, 10);
		document.getElementById('date2').innerHTML = date.toISOString().substring(0, 10);
		document.getElementById('date3').innerHTML = date.toISOString().substring(0, 10);
	}


	async function render_true_graphs() {
		var pushDate = date.toISOString().substring(0, 10);
		const javaScriptRelease = Date.parse(pushDate)/1000;
		var data = {
			date: javaScriptRelease
    	};
		var json = JSON.stringify(data);

		var xValues = [];

		//True Data Values
		var bdrmValues = [];
		var lvngrmValues = [];
		var ktchnValues = [];

		
		var requestURL = "https://webhooks.mongodb-realm.com/api/client/v2.0/app/predictor-rjhbq/service/sendWebApp/incoming_webhook/webhook_collectBLE?secret=SIoT";
		var xhr = new XMLHttpRequest();
		xhr.open("POST", requestURL);
		xhr.setRequestHeader("Accept", "application/json");
		xhr.send(json);

		xhr.onreadystatechange = function () {
		if (xhr.readyState === 4) {
			var collectedBLEData = JSON.parse(xhr.responseText);
			for(var i = 0; i < collectedBLEData.length; i++) {
				var obj = collectedBLEData[i];
				var time = new Date(obj.timeStampID.$numberInt*1000).toISOString().substring(11, 16);
				xValues.push(time);
				
				try {
					bdrmRSSI = Number(obj.rssiBDRM.$numberInt);
					bdrmValues.push(bdrmRSSI);
				}
				catch(err) {
					bdrmValues.push(-100);
				}

				try {
					ktchnRSSI = Number(obj.rssiKTCHN.$numberInt);
					ktchnValues.push(ktchnRSSI);
				}
				catch(err) {
					ktchnValues.push(-100);
				}

				try {
					lvngrmRSSI = Number(obj.rssiLVNGRM.$numberInt);
					lvngrmValues.push(lvngrmRSSI);
				}
				catch(err) {
					lvngrmValues.push(-100);
				}

			}

			new Chart("bedroom", {
			type: "line",
			data: {
				labels: xValues,
				datasets: [{
				data: bdrmValues,
				borderColor: "red",
				fill: false
				}]
			},
			options: {
				legend: {display: false}
			}
			});

			new Chart("livingroom", {
			type: "line",
			data: {
				labels: xValues,
				datasets: [{
				data: lvngrmValues,
				borderColor: "green",
				fill: false
				}]
			},
			options: {
				legend: {display: false}
			}
			});

			new Chart("kitchen", {
			type: "line",
			data: {
				labels: xValues,
				datasets: [{
				data: ktchnValues,
				borderColor: "blue",
				fill: false
				}]
			},
			options: {
				legend: {display: false}
			}
			});

		}};
	}


	async function render_prediction_graphs() {
		var pushDate = date.toISOString().substring(0, 10);
		const javaScriptRelease = Date.parse(pushDate)/1000;
		var data = {
			date: javaScriptRelease
    	};
		var json = JSON.stringify(data);

		var xValues = [];

		//Prediction Values
		var ktchnBool = [];
		var bdrmBool = [];
		var lvngrmBool = [];
		var wyBool = [];

		
		var requestURL = "https://webhooks.mongodb-realm.com/api/client/v2.0/app/predictor-rjhbq/service/sendWebApp/incoming_webhook/webhook_collectBLE?secret=SIoT";
		var xhr = new XMLHttpRequest();
		xhr.open("POST", requestURL);
		xhr.setRequestHeader("Accept", "application/json");
		xhr.send(json);

		xhr.onreadystatechange = function () {
		if (xhr.readyState === 4) {
			var collectedBLEData = JSON.parse(xhr.responseText);
			for(var i = 0; i < collectedBLEData.length; i++) {

				var obj = collectedBLEData[i];
				
				try {

					//Collect Values
					bdrmRSSI = Number(obj.rssiBDRM.$numberInt);
					lvngrmRSSI = Number(obj.rssiLVNGRM.$numberInt);
					ktchnRSSI = Number(obj.rssiKTCHN.$numberInt);
					var time = new Date(obj.timeStampID.$numberInt*1000).toISOString().substring(11, 16);

					

					//Prediction Graphs
					if (bdrmRSSI == -100 && lvngrmRSSI == -100 && ktchnRSSI == -100) {
						ktchnBool.push(0);
						lvngrmBool.push(0);
						bdrmBool.push(0);
						wyBool.push(1);
						xValues.push(time);
					}
					else if (bdrmRSSI >= ktchnRSSI && bdrmRSSI >= lvngrmRSSI) {
						ktchnBool.push(0);
						lvngrmBool.push(0);
						bdrmBool.push(1);
						wyBool.push(0);
						xValues.push(time);
					}
					else if (lvngrmRSSI >= bdrmRSSI && lvngrmRSSI >= ktchnRSSI) {
						ktchnBool.push(0);
						lvngrmBool.push(1);
						bdrmBool.push(0);
						wyBool.push(0);
						xValues.push(time);
					}

					else if (ktchnRSSI >= bdrmRSSI && ktchnRSSI >= lvngrmRSSI) {
						ktchnBool.push(1);
						lvngrmBool.push(0);
						bdrmBool.push(0);
						wyBool.push(0);
						xValues.push(time);
					}

				}
				catch(err) {
				}

			}

			console.log(xValues[0])

			new Chart("roomlocation", {
			type: "line",
			data: {
				labels: xValues,
				datasets: [{
				data: bdrmBool,
				borderColor: "red",
				fill: true
				},{
				data: ktchnBool,
				borderColor: "green",
				fill: true
				},{
				data: lvngrmBool,
				borderColor: "blue",
				fill: true
				},{
				data: wyBool,
				borderColor: "black",
				fill: true
				}]
			},
			options: {
				legend: {display: false}
			}
			});

		}};
	}

</script>





</html>